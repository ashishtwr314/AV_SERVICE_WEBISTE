{"ast":null,"code":"import { Fragment as _Fragment } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport { useState } from \"react\";\nimport { message, Result } from \"antd\";\n// config\nimport { DOMAIN_URL } from \"../../../../../config/index\";\nconsole.log(\"DOMAIN URL\", DOMAIN_URL); // components\n\nimport Feedback from \"../feedback/components/Feedback\"; // utils\n\nimport { SC } from \"./utils\";\nimport { submitFeedback } from \"../../../../utils/Apicalls\";\nimport router from \"next/router\";\nimport { cryptData } from \"../../../../utils/utils\";\n\nconst Header = ({\n  companyInfo\n}) => {\n  return /*#__PURE__*/_jsx(_Fragment, {\n    children: /*#__PURE__*/_jsx(\"header\", {\n      children: /*#__PURE__*/_jsx(\"div\", {\n        className: \"d-flex flex-column flex-md-row align-items-center pb-3 mb-4 border-bottom\",\n        children: /*#__PURE__*/_jsxs(\"a\", {\n          href: \"/\",\n          className: \"d-flex align-items-center text-dark text-decoration-none\",\n          children: [/*#__PURE__*/_jsx(\"img\", {\n            className: \"logo-size\",\n            src: companyInfo === null || companyInfo === void 0 ? void 0 : companyInfo.c_logo\n          }), \"\\xA0\\xA0\", /*#__PURE__*/_jsxs(\"span\", {\n            className: \"fs-4\",\n            children: [companyInfo === null || companyInfo === void 0 ? void 0 : companyInfo.c_name, \" - Feedback Surveys\"]\n          })]\n        })\n      })\n    })\n  });\n};\n\nconst FeedbackDescription = ({\n  feedbackInfo,\n  survey,\n  submitedStat\n}) => {\n  const {\n    0: questions,\n    1: setQuestions\n  } = useState(typeof feedbackInfo.q_format !== \"undefined\" && feedbackInfo.q_format !== \"\" ? JSON.parse(feedbackInfo.q_format) : []);\n\n  const f_questionEditor_cust = (uuid, type, value, option) => {\n    if (value) {\n      setAnswered(true);\n    } else {\n      setAnswered(false);\n    }\n\n    console.log(uuid, type, value, questions, option);\n    const result = SC.fc.f_questionEditor(uuid, type, value, questions, option);\n    setQuestions(result);\n  };\n\n  const {\n    0: userData,\n    1: setUserData\n  } = useState({\n    name: \"\",\n    email: \"\"\n  });\n  const {\n    0: startTime,\n    1: setStartTime\n  } = useState(null);\n  const {\n    0: answered,\n    1: setAnswered\n  } = useState(false);\n\n  const handleSubmit = () => {\n    const handleFeedbackSubmit = async () => {\n      const {\n        c,\n        ct,\n        f\n      } = router.query;\n      const c_id = await cryptData(\"dec\", c);\n      const fc_id = await cryptData(\"dec\", ct);\n      const fdq_id = await cryptData(\"dec\", f);\n      const endTime = new Date().getTime();\n      const time = endTime - startTime;\n      let sec = Math.floor(time / 1000 % 60); // console.log(\"Time taken\", sec);\n\n      const formData = new FormData();\n      formData.append(\"c_id\", c_id);\n      formData.append(\"fc_id\", fc_id);\n      formData.append(\"fdq_id\", fdq_id);\n      formData.append(\"fdqa_time_taken_to_finish\", JSON.stringify(sec));\n      formData.append(\"fdqa_qst_ans_json_format\", JSON.stringify(questions));\n      formData.append(\"name\", userData === null || userData === void 0 ? void 0 : userData.name);\n      formData.append(\"email\", userData === null || userData === void 0 ? void 0 : userData.email);\n      console.log(formData);\n\n      try {\n        const res = await submitFeedback(formData);\n        console.log(\"RES\", res); //     {\n        //     c_id: parseInt(c_id),\n        //     fc_id: parseInt(fc_id),\n        //     fdq_id: parseInt(fdq_id),\n        // name: userData?.name,\n        // email: userData?.email,\n        //     fdqa_time_taken_to_finish: sec,\n        //     fdqa_qst_ans_json_format: questions,\n        // }\n\n        submitedStat.setIsSubmitted(true);\n      } catch (err) {\n        var _err$response$data, _err$response$data$me, _err$response$data2, _err$response$data2$m, _err$response$data3, _err$response$data3$m, _err$response$data4, _err$response$data4$m;\n\n        ((_err$response$data = err.response.data) === null || _err$response$data === void 0 ? void 0 : (_err$response$data$me = _err$response$data.message) === null || _err$response$data$me === void 0 ? void 0 : _err$response$data$me.email) && message.error((_err$response$data2 = err.response.data) === null || _err$response$data2 === void 0 ? void 0 : (_err$response$data2$m = _err$response$data2.message) === null || _err$response$data2$m === void 0 ? void 0 : _err$response$data2$m.email[0]);\n        ((_err$response$data3 = err.response.data) === null || _err$response$data3 === void 0 ? void 0 : (_err$response$data3$m = _err$response$data3.message) === null || _err$response$data3$m === void 0 ? void 0 : _err$response$data3$m.name) && message.error((_err$response$data4 = err.response.data) === null || _err$response$data4 === void 0 ? void 0 : (_err$response$data4$m = _err$response$data4.message) === null || _err$response$data4$m === void 0 ? void 0 : _err$response$data4$m.name[0]);\n      }\n    };\n\n    handleFeedbackSubmit();\n  };\n\n  return /*#__PURE__*/_jsxs(_Fragment, {\n    children: [/*#__PURE__*/_jsxs(\"div\", {\n      className: \"container-fluid py-5\",\n      children: [/*#__PURE__*/_jsx(\"h1\", {\n        className: \"display-5 fw-bold\",\n        children: feedbackInfo === null || feedbackInfo === void 0 ? void 0 : feedbackInfo.title\n      }), /*#__PURE__*/_jsx(\"p\", {\n        className: \"col-md-8 fs-4\",\n        children: feedbackInfo === null || feedbackInfo === void 0 ? void 0 : feedbackInfo.description\n      }), !survey.isSurveyClicked ? /*#__PURE__*/_jsxs(\"form\", {\n        onSubmit: e => {\n          e.preventDefault;\n          console.log(\"take survey\");\n          setStartTime(new Date().getTime());\n          survey.setIsSurveyClicked(true);\n        },\n        children: [/*#__PURE__*/_jsxs(\"div\", {\n          className: \"form-group mb-3\",\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            htmlFor: \"inputUserName\",\n            children: \"Name\"\n          }), /*#__PURE__*/_jsx(\"input\", {\n            type: \"text\",\n            className: \"form-control\",\n            id: \"inputUserName\",\n            \"aria-describedby\": \"input-user-name\",\n            placeholder: \"Enter name\",\n            required: true,\n            onChange: e => setUserData(s => _objectSpread(_objectSpread({}, s), {}, {\n              name: e.target.value\n            }))\n          })]\n        }), /*#__PURE__*/_jsxs(\"div\", {\n          className: \"form-group mb-3\",\n          children: [/*#__PURE__*/_jsx(\"label\", {\n            htmlFor: \"inputUserEmail\",\n            children: \"Email address\"\n          }), /*#__PURE__*/_jsx(\"input\", {\n            type: \"email\",\n            className: \"form-control\",\n            id: \"inputUserEmail\",\n            \"aria-describedby\": \"input-user-email\",\n            placeholder: \"Enter email\" // required\n            ,\n            onChange: e => setUserData(s => _objectSpread(_objectSpread({}, s), {}, {\n              email: e.target.value\n            }))\n          })]\n        }), /*#__PURE__*/_jsx(\"button\", {\n          className: \"btn btn-primary btn-lg\",\n          type: \"submit\",\n          children: \"Take Survey\"\n        })]\n      }) : /*#__PURE__*/_jsx(_Fragment, {}) // <button\n      //     onClick={() => {\n      //         console.log(\"cancel survey\");\n      //         survey.setIsSurveyClicked(false);\n      //     }}\n      //     className=\"btn btn-danger btn-lg\"\n      //     type=\"button\"\n      // >\n      //     Cancel Survey\n      // </button>\n      ]\n    }), survey.isSurveyClicked && /*#__PURE__*/_jsx(\"div\", {\n      className: \"container-fluid py-5\",\n      children: /*#__PURE__*/_jsx(Feedback, {\n        setQuestions: setQuestions,\n        answered: answered,\n        setAnswered: setAnswered,\n        questions: questions,\n        f_questionEditor_cust: f_questionEditor_cust,\n        handleSubmit: handleSubmit\n      })\n    })]\n  });\n};\n\nconst PageLayout = ({\n  feedbackContent,\n  survey\n}) => {\n  const {\n    0: isSubmitted,\n    1: setIsSubmitted\n  } = useState(false);\n  return /*#__PURE__*/_jsxs(\"div\", {\n    className: \"container py-4\",\n    children: [/*#__PURE__*/_jsx(Header, {\n      companyInfo: feedbackContent === null || feedbackContent === void 0 ? void 0 : feedbackContent.companyInfo\n    }), /*#__PURE__*/_jsx(\"div\", {\n      className: \"p-5 mb-4 rounded-3 shadow-lg\",\n      children: !isSubmitted ? /*#__PURE__*/_jsx(FeedbackDescription, {\n        feedbackInfo: feedbackContent === null || feedbackContent === void 0 ? void 0 : feedbackContent.feedbackInfo,\n        survey: survey,\n        submitedStat: {\n          isSubmitted,\n          setIsSubmitted\n        }\n      }) : /*#__PURE__*/_jsx(Result, {\n        status: \"success\",\n        title: \"Feedback has been Successfully Submitted!\",\n        subTitle: \"Thanks for completing this Feedback. Now create your own \\u2014 it's free, easy, & beautiful\",\n        extra: /*#__PURE__*/_jsx(\"button\", {\n          className: \"btn btn-primary\",\n          type: \"button\",\n          onClick: () => location.reload(),\n          children: \"Take me there!\"\n        })\n      })\n    })]\n  });\n};\n\nexport default PageLayout;","map":null,"metadata":{},"sourceType":"module"}